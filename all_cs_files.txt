using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Net.Http;
using System.Text;
using System.Threading.Tasks;
using System.Text.RegularExpressions;
using Newtonsoft.Json;

namespace APIGigaChatImage_Kantuganov
{
    public class Program
    {
        static string ClientId = "7879c628-132f-4ec9-b371-309d6472aa56";
        static string AuthorizationKey = "Nzg3OWM2MjgtMTMyZi00ZWM5LWIzNzEtMzA5ZDY0NzJhYTU2OmI2ZmM2MDdjLWY2MGEtNDhmYi04MDQ2LTY3Y2U0NzNlMDA1NA==";

        static async Task Main(string[] args)
        {

            Console.Write("Введите описание для изображения: ");
            string userPrompt = Console.ReadLine();

            if (string.IsNullOrWhiteSpace(userPrompt))
            {
                userPrompt = "Красивый пейзаж с горами и озером при закате";
            }

            string accessToken = await GetToken(ClientId, AuthorizationKey);

            if (accessToken == null)
            {
                Console.WriteLine("Не удалось получить токен. Использую стандартные обои.");
                UseDefaultWallpaper();
                WaitForExit();
                return;
            }

            string imageFileId = await GenerateImage(accessToken, userPrompt);

            if (imageFileId == null)
            {
                Console.WriteLine("Не удалось сгенерировать изображение. Использую стандартные обои.");
                UseDefaultWallpaper();
                WaitForExit();
                return;
            }

            string downloadedImagePath = await DownloadImage(accessToken, imageFileId);

            if (downloadedImagePath == null || !File.Exists(downloadedImagePath))
            {
                Console.WriteLine("Не удалось скачать изображение. Использую стандартные обои.");
                UseDefaultWallpaper();
                WaitForExit();
                return;
            }

            bool wallpaperSet = Wallpapersetter.SetWallpaper(downloadedImagePath);

            if (wallpaperSet)
            {
                Console.WriteLine("Обои успешно установлены!");
            }
            else
            {
                Console.WriteLine("Не удалось установить обои. Использую стандартные обои.");
                UseDefaultWallpaper();
            }

            WaitForExit();
        }

        private static void WaitForExit()
        {
            Console.WriteLine("\nНажмите любую клавишу для выхода...");
            Console.ReadKey();
        }

        private static void UseDefaultWallpaper()
        {
            try
            {
                string defaultWallpaper = @"C:\Users\student-A502.PERMAVIAT\Pictures\Снимок.png";

                if (File.Exists(defaultWallpaper))
                {
                    Wallpapersetter.SetWallpaper(defaultWallpaper);
                }
            }
            catch { }
        }

        public static async Task<string> GetToken(string rpUID, string bearer)
        {
            try
            {
                string returnToken = null;
                string uri = "https://ngw.devices.sberbank.ru:9443/api/v2/oauth";

                using (HttpClientHandler handler = new HttpClientHandler())
                {
                    handler.ServerCertificateCustomValidationCallback = (message, cert, chain, sslPolicyErrors) => true;

                    using (HttpClient client = new HttpClient(handler))
                    {
                        HttpRequestMessage request = new HttpRequestMessage(HttpMethod.Post, uri);

                        request.Headers.Add("Accept", "application/json");
                        request.Headers.Add("Authorization", $"Bearer {bearer}");
                        request.Headers.Add("RqUID", rpUID);

                        var formData = new List<KeyValuePair<string, string>>
                        {
                            new KeyValuePair<string, string>("scope", "GIGACHAT_API_PERS")
                        };

                        request.Content = new FormUrlEncodedContent(formData);

                        HttpResponseMessage response = await client.SendAsync(request);

                        if (response.IsSuccessStatusCode)
                        {
                            string responseContent = await response.Content.ReadAsStringAsync();
                            var tokenResponse = JsonConvert.DeserializeObject<TokenResponse>(responseContent);
                            returnToken = tokenResponse?.access_token;
                        }
                    }
                }

                return returnToken;
            }
            catch
            {
                return null;
            }
        }

        public static async Task<string> GenerateImage(string accessToken, string prompt)
        {
            try
            {
                string uri = "https://gigachat.devices.sberbank.ru/api/v1/chat/completions";

                using (HttpClientHandler handler = new HttpClientHandler())
                {
                    handler.ServerCertificateCustomValidationCallback = (message, cert, chain, sslPolicyErrors) => true;

                    using (HttpClient client = new HttpClient(handler))
                    {
                        client.Timeout = TimeSpan.FromSeconds(120);

                        HttpRequestMessage request = new HttpRequestMessage(HttpMethod.Post, uri);

                        request.Headers.Add("Accept", "application/json");
                        request.Headers.Add("Authorization", $"Bearer {accessToken}");

                        var requestBody = new
                        {
                            model = "GigaChat",
                            messages = new[]
                            {
                                new
                                {
                                    role = "system",
                                    content = "Ты - профессиональный художник. Создавай красивые и детализированные изображения в высоком качестве."
                                },
                                new
                                {
                                    role = "user",
                                    content = prompt
                                }
                            },
                            function_call = "auto"
                        };

                        string jsonBody = JsonConvert.SerializeObject(requestBody);
                        request.Content = new StringContent(jsonBody, Encoding.UTF8, "application/json");

                        HttpResponseMessage response = await client.SendAsync(request);

                        if (response.IsSuccessStatusCode)
                        {
                            string responseContent = await response.Content.ReadAsStringAsync();
                            var chatResponse = JsonConvert.DeserializeObject<ChatCompletionResponse>(responseContent);

                            if (chatResponse?.choices != null && chatResponse.choices.Count > 0)
                            {
                                string content = chatResponse.choices[0]?.message?.content;

                                if (!string.IsNullOrEmpty(content))
                                {
                                    var match = Regex.Match(content, @"<img\s+src=""([^""]+)""\s+fuse=""true""\s*/>");

                                    if (match.Success && match.Groups.Count > 1)
                                    {
                                        return match.Groups[1].Value;
                                    }
                                }
                            }
                        }
                    }
                }

                return null;
            }
            catch
            {
                return null;
            }
        }

        public static async Task<string> DownloadImage(string accessToken, string fileId)
        {
            try
            {
                string uri = $"https://gigachat.devices.sberbank.ru/api/v1/files/{fileId}/content";
                string fileName = $"gigachat_wallpaper_{DateTime.Now:yyyyMMdd_HHmmss}.jpg";
                string downloadPath = Path.Combine(AppDomain.CurrentDomain.BaseDirectory, fileName);

                using (HttpClientHandler handler = new HttpClientHandler())
                {
                    handler.ServerCertificateCustomValidationCallback = (message, cert, chain, sslPolicyErrors) => true;

                    using (HttpClient client = new HttpClient(handler))
                    {
                        client.Timeout = TimeSpan.FromSeconds(60);

                        HttpRequestMessage request = new HttpRequestMessage(HttpMethod.Get, uri);

                        request.Headers.Add("Accept", "application/jpg");
                        request.Headers.Add("Authorization", $"Bearer {accessToken}");

                        HttpResponseMessage response = await client.SendAsync(request);

                        if (response.IsSuccessStatusCode)
                        {
                            byte[] imageBytes = await response.Content.ReadAsByteArrayAsync();

                            if (imageBytes.Length == 0)
                            {
                                return null;
                            }

                            var contentType = response.Content.Headers.ContentType?.MediaType;
                            string extension = ".jpg";

                            if (contentType != null)
                            {
                                if (contentType.ToLower() == "image/png")
                                {
                                    extension = ".png";
                                }
                                else if (contentType.ToLower() == "image/jpeg" || contentType.ToLower() == "image/jpg")
                                {
                                    extension = ".jpg";
                                }
                                else if (contentType.ToLower() == "image/bmp")
                                {
                                    extension = ".bmp";
                                }
                                else if (contentType.ToLower() == "image/webp")
                                {
                                    extension = ".webp";
                                }
                            }

                            if (!fileName.EndsWith(extension, StringComparison.OrdinalIgnoreCase))
                            {
                                fileName = Path.GetFileNameWithoutExtension(fileName) + extension;
                                downloadPath = Path.Combine(AppDomain.CurrentDomain.BaseDirectory, fileName);
                            }

                            File.WriteAllBytes(downloadPath, imageBytes);

                            if (File.Exists(downloadPath))
                            {
                                return downloadPath;
                            }
                        }
                    }
                }

                return null;
            }
            catch
            {
                return null;
            }
        }

        public class TokenResponse
        {
            public string access_token { get; set; }
            public string expired_at { get; set; }
        }

        public class ChatCompletionResponse
        {
            public List<Choice> choices { get; set; }
            public long created { get; set; }
            public string model { get; set; }
            public string @object { get; set; }
            public Usage usage { get; set; }
        }

        public class Choice
        {
            public Message message { get; set; }
            public int index { get; set; }
            public string finish_reason { get; set; }
        }

        public class Message
        {
            public string content { get; set; }
            public string role { get; set; }
        }

        public class Usage
        {
            public int prompt_tokens { get; set; }
            public int completion_tokens { get; set; }
            public int total_tokens { get; set; }
        }

        public class Wallpapersetter
        {
            private const int SPI_SETDESKWALLPAPER = 0x0014;
            private const int SPIF_UPDATEINIFILE = 0x01;
            private const int SPIF_SENDWININICHANGE = 0x02;

            [System.Runtime.InteropServices.DllImport("user32.dll", CharSet = System.Runtime.InteropServices.CharSet.Auto)]
            private static extern int SystemParametersInfo(
                int uAction,
                int uParam,
                string lpvParam,
                int fuWinIni
            );

            public static bool SetWallpaper(string imagePath)
            {
                try
                {
                    if (!File.Exists(imagePath))
                    {
                        return false;
                    }

                    int result = SystemParametersInfo(
                        SPI_SETDESKWALLPAPER,
                        0,
                        imagePath,
                        SPIF_UPDATEINIFILE | SPIF_SENDWININICHANGE
                    );

                    return result != 0;
                }
                catch
                {
                    return false;
                }
            }
        }
    }
}﻿using System;
using System.Collections.Generic;
using System.Linq;
using System.Runtime.InteropServices;
using System.Text;
using System.Threading.Tasks;

namespace APIGigaChatImage_Kantuganov.Classes
{
    public class Wallpapersetter
    {
        private const int SPI_SETDESKWALLPAPER = 0x0014;
        private const int SPIF_UPDATEINIFILE = 0x01;
        private const int SPIF_SENDWININICHANGE = 0x02;

        [DllImport("user32.dll", CharSet = CharSet.Auto)]
        private static extern int SystemParametersInfo(
            int uAction,
            int uParam,
            string lpvParam,
            int fuWinIni
        );

        public static void SetWallpaper(string imagePath)
        {
            try
            {
                SystemParametersInfo(
                    SPI_SETDESKWALLPAPER,
                    0,
                    imagePath,
                    SPIF_UPDATEINIFILE | SPIF_SENDWININICHANGE
                );
                Console.WriteLine($"Обои установлены: {imagePath}");
            }
            catch (Exception ex)
            {
                Console.WriteLine($"Ошибка: {ex.Message}");
            }
        }
    }
}
﻿using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace APIGigaChatImage_Kantuganov.Models.Response
{
    public class ImageGenerationResponse
    {
        public long created { get; set; }
        public List<ImageData> data { get; set; }
    }

    public class ImageData
    {
        public string url { get; set; }
        public string b64_json { get; set; }
    }
}
﻿using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace APIGigaChatImage_Kantuganov.Models.Response
{
    public class ResponseToken
    {
        public string access_token { get; set; }
        public string expired_at { get; set; }
    }
}
// <autogenerated />
using System;
using System.Reflection;
[assembly: global::System.Runtime.Versioning.TargetFrameworkAttribute(".NETFramework,Version=v4.7.2", FrameworkDisplayName = ".NET Framework 4.7.2")]
﻿using System.Reflection;
using System.Runtime.CompilerServices;
using System.Runtime.InteropServices;

// Общие сведения об этой сборке предоставляются следующим набором
// набора атрибутов. Измените значения этих атрибутов для изменения сведений,
// связанные с этой сборкой.
[assembly: AssemblyTitle("APIGigaChatImage_Kantuganov")]
[assembly: AssemblyDescription("")]
[assembly: AssemblyConfiguration("")]
[assembly: AssemblyCompany("")]
[assembly: AssemblyProduct("APIGigaChatImage_Kantuganov")]
[assembly: AssemblyCopyright("Copyright ©  2025")]
[assembly: AssemblyTrademark("")]
[assembly: AssemblyCulture("")]

// Установка значения False для параметра ComVisible делает типы в этой сборке невидимыми
// для компонентов COM. Если необходимо обратиться к типу в этой сборке через
// из модели COM задайте для атрибута ComVisible этого типа значение true.
[assembly: ComVisible(false)]

// Следующий GUID представляет идентификатор typelib, если этот проект доступен из модели COM
[assembly: Guid("54fd9ef4-35b8-4540-a8d1-c0a70b37dc76")]

// Сведения о версии сборки состоят из указанных ниже четырех значений:
//
//      Основной номер версии
//      Дополнительный номер версии
//      Номер сборки
//      Номер редакции
//
[assembly: AssemblyVersion("1.0.0.0")]
[assembly: AssemblyFileVersion("1.0.0.0")]
﻿using System.Configuration;
using System.Data;
using System.Windows;

namespace GigaChatImage_Kantuganov
{
    /// <summary>
    /// Interaction logic for App.xaml
    /// </summary>
    public partial class App : Application
    {
    }

}
using System.Windows;

[assembly: ThemeInfo(
    ResourceDictionaryLocation.None,            //where theme specific resource dictionaries are located
                                                //(used if a resource is not found in the page,
                                                // or application resource dictionaries)
    ResourceDictionaryLocation.SourceAssembly   //where the generic resource dictionary is located
                                                //(used if a resource is not found in the page,
                                                // app, or any theme specific resource dictionaries)
)]
﻿using Microsoft.Win32;
using Newtonsoft.Json;
using System.IO;
using System.Net.Http;
using System.Text;
using System.Text.RegularExpressions;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;

namespace GigaChatImage_Kantuganov
{
    /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {
        private const string ClientId = "7879c628-132f-4ec9-b371-309d6472aa56";
        private const string AuthorizationKey = "Nzg3OWM2MjgtMTMyZi00ZWM5LWIzNzEtMzA5ZDY0NzJhYTU2OmI2ZmM2MDdjLWY2MGEtNDhmYi04MDQ2LTY3Y2U0NzNlMDA1NA==";

        private string currentImagePath = null;
        private string accessToken = null;

        public MainWindow()
        {
            InitializeComponent();

            StyleComboBox.SelectionChanged += ParametersChanged;
            ColorPaletteComboBox.SelectionChanged += ParametersChanged;
            AspectRatioComboBox.SelectionChanged += ParametersChanged;
            QualityComboBox.SelectionChanged += ParametersChanged;
            AddDetailsCheckBox.Checked += ParametersChanged;
            AddDetailsCheckBox.Unchecked += ParametersChanged;
            AddLightingCheckBox.Checked += ParametersChanged;
            AddLightingCheckBox.Unchecked += ParametersChanged;
            HighResCheckBox.Checked += ParametersChanged;
            HighResCheckBox.Unchecked += ParametersChanged;
            PromptTextBox.TextChanged += ParametersChanged;

            CopyPromptButton.Click += CopyPromptButton_Click;

            UpdateGeneratedPrompt();

            _ = InitializeToken();
        }

        private async Task InitializeToken()
        {
            StatusTextBlock.Text = "Получение токена...";
            ProgressBar.IsIndeterminate = true;

            accessToken = await GetToken(ClientId, AuthorizationKey);

            if (accessToken != null)
            {
                StatusTextBlock.Text = "Токен получен. Готов к генерации!";
                GenerateButton.IsEnabled = true;
            }
            else
            {
                StatusTextBlock.Text = "Не удалось получить токен. Проверьте соединение.";
                GenerateButton.IsEnabled = false;
            }

            ProgressBar.IsIndeterminate = false;
        }

        private void ParametersChanged(object sender, RoutedEventArgs e)
        {
            UpdateGeneratedPrompt();
        }

        private void UpdateGeneratedPrompt()
        {
            string basePrompt = PromptTextBox.Text;
            string style = ((ComboBoxItem)StyleComboBox.SelectedItem)?.Tag?.ToString();
            string palette = ((ComboBoxItem)ColorPaletteComboBox.SelectedItem)?.Tag?.ToString();
            string aspectRatio = ((ComboBoxItem)AspectRatioComboBox.SelectedItem)?.Tag?.ToString();
            string quality = ((ComboBoxItem)QualityComboBox.SelectedItem)?.Tag?.ToString();

            StringBuilder enhancedPrompt = new StringBuilder();
            enhancedPrompt.Append(basePrompt);

            if (!string.IsNullOrEmpty(style))
            {
                string styleText = GetStyleDescription(style);
                if (!string.IsNullOrEmpty(styleText))
                {
                    enhancedPrompt.Append($", {styleText}");
                }
            }

            if (!string.IsNullOrEmpty(palette))
            {
                string paletteText = GetPaletteDescription(palette);
                if (!string.IsNullOrEmpty(paletteText))
                {
                    enhancedPrompt.Append($", {paletteText}");
                }
            }

            if (AddDetailsCheckBox.IsChecked == true)
            {
                enhancedPrompt.Append(", детализированное");
            }

            if (AddLightingCheckBox.IsChecked == true)
            {
                enhancedPrompt.Append(", драматическое освещение");
            }

            if (HighResCheckBox.IsChecked == true)
            {
                enhancedPrompt.Append(", высокое разрешение, 4K");
            }

            if (!string.IsNullOrEmpty(aspectRatio))
            {
                enhancedPrompt.Append($", соотношение сторон {aspectRatio}");
            }

            GeneratedPromptTextBox.Text = enhancedPrompt.ToString();
        }

        private string GetStyleDescription(string styleTag)
        {
            return styleTag switch
            {
                "realistic" => "реалистичный стиль",
                "painting" => "в стиле масляной живописи",
                "anime" => "в стиле аниме",
                "cyberpunk" => "в стиле киберпанк",
                "fantasy" => "в стиле фэнтези",
                "minimalism" => "минималистичный стиль",
                "surreal" => "сюрреалистичный стиль",
                "pixelart" => "в стиле пиксель-арт",
                _ => string.Empty
            };
        }

        private string GetPaletteDescription(string paletteTag)
        {
            return paletteTag switch
            {
                "bright" => "яркие насыщенные цвета",
                "pastel" => "пастельные тона",
                "monochrome" => "монохромная цветовая гамма",
                "dark" => "тёмная цветовая тема",
                "warm" => "тёплая цветовая гамма",
                "cool" => "холодная цветовая гамма",
                "neon" => "неоновая цветовая гамма",
                "natural" => "естественные природные цвета",
                _ => string.Empty
            };
        }

        private void CopyPromptButton_Click(object sender, RoutedEventArgs e)
        {
            Clipboard.SetText(GeneratedPromptTextBox.Text);
            StatusTextBlock.Text = "Промпт скопирован в буфер обмена!";
        }

        private async void GenerateButton_Click(object sender, RoutedEventArgs e)
        {
            if (string.IsNullOrWhiteSpace(PromptTextBox.Text))
            {
                MessageBox.Show("Введите описание для генерации изображения", "Ошибка",
                    MessageBoxButton.OK, MessageBoxImage.Warning);
                return;
            }

            if (accessToken == null)
            {
                MessageBox.Show("Токен не получен. Проверьте соединение и попробуйте снова.", "Ошибка",
                    MessageBoxButton.OK, MessageBoxImage.Error);
                return;
            }

            try
            {
                SetUiState(false);
                StatusTextBlock.Text = "Генерация изображения...";
                ProgressBar.IsIndeterminate = true;

                string enhancedPrompt = GeneratedPromptTextBox.Text;
                string imageFileId = await GenerateImage(accessToken, enhancedPrompt);

                if (imageFileId == null)
                {
                    StatusTextBlock.Text = "Не удалось сгенерировать изображение";
                    MessageBox.Show("Не удалось сгенерировать изображение. Попробуйте другой запрос.",
                        "Ошибка", MessageBoxButton.OK, MessageBoxImage.Error);
                    return;
                }

                StatusTextBlock.Text = "Загрузка изображения...";
                currentImagePath = await DownloadImage(accessToken, imageFileId);

                if (currentImagePath == null || !File.Exists(currentImagePath))
                {
                    StatusTextBlock.Text = "Не удалось загрузить изображение";
                    MessageBox.Show("Не удалось загрузить изображение. Проверьте соединение.",
                        "Ошибка", MessageBoxButton.OK, MessageBoxImage.Error);
                    return;
                }

                StatusTextBlock.Text = "Изображение готово!";

                SetWallpaperButton.IsEnabled = true;
                SaveButton.IsEnabled = true;

            }
            catch (Exception ex)
            {
                StatusTextBlock.Text = $"Ошибка: {ex.Message}";
                MessageBox.Show($"Произошла ошибка: {ex.Message}", "Ошибка",
                    MessageBoxButton.OK, MessageBoxImage.Error);
            }
            finally
            {
                ProgressBar.IsIndeterminate = false;
                SetUiState(true);
            }
        }

        private void SetUiState(bool isEnabled)
        {
            GenerateButton.IsEnabled = isEnabled;
            PromptTextBox.IsEnabled = isEnabled;
            StyleComboBox.IsEnabled = isEnabled;
            ColorPaletteComboBox.IsEnabled = isEnabled;
            AspectRatioComboBox.IsEnabled = isEnabled;
            QualityComboBox.IsEnabled = isEnabled;
            AddDetailsCheckBox.IsEnabled = isEnabled;
            AddLightingCheckBox.IsEnabled = isEnabled;
            HighResCheckBox.IsEnabled = isEnabled;
            CopyPromptButton.IsEnabled = isEnabled;
        }



        private void SetWallpaperButton_Click(object sender, RoutedEventArgs e)
        {
            if (string.IsNullOrEmpty(currentImagePath) || !File.Exists(currentImagePath))
            {
                MessageBox.Show("Изображение не найдено", "Ошибка",
                    MessageBoxButton.OK, MessageBoxImage.Warning);
                return;
            }

            try
            {
                bool wallpaperSet = WallpaperHelper.SetWallpaper(currentImagePath);

                if (wallpaperSet)
                {
                    StatusTextBlock.Text = "Обои успешно установлены!";
                    MessageBox.Show("Обои успешно установлены!", "Успех",
                        MessageBoxButton.OK, MessageBoxImage.Information);
                }
                else
                {
                    StatusTextBlock.Text = "Не удалось установить обои";
                    MessageBox.Show("Не удалось установить обои", "Ошибка",
                        MessageBoxButton.OK, MessageBoxImage.Error);
                }
            }
            catch (Exception ex)
            {
                MessageBox.Show($"Ошибка при установке обоев: {ex.Message}", "Ошибка",
                    MessageBoxButton.OK, MessageBoxImage.Error);
            }
        }

        private void SaveButton_Click(object sender, RoutedEventArgs e)
        {
            if (string.IsNullOrEmpty(currentImagePath) || !File.Exists(currentImagePath))
            {
                MessageBox.Show("Изображение не найдено", "Ошибка",
                    MessageBoxButton.OK, MessageBoxImage.Warning);
                return;
            }

            try
            {
                SaveFileDialog saveDialog = new SaveFileDialog
                {
                    Filter = "JPEG Image|*.jpg|PNG Image|*.png|BMP Image|*.bmp|All files|*.*",
                    FileName = $"wallpaper_{DateTime.Now:yyyyMMdd_HHmmss}",
                    DefaultExt = ".jpg"
                };

                if (saveDialog.ShowDialog() == true)
                {
                    File.Copy(currentImagePath, saveDialog.FileName, true);
                    StatusTextBlock.Text = $"Изображение сохранено: {saveDialog.FileName}";
                    MessageBox.Show($"Изображение сохранено в:\n{saveDialog.FileName}", "Успех",
                        MessageBoxButton.OK, MessageBoxImage.Information);
                }
            }
            catch (Exception ex)
            {
                MessageBox.Show($"Ошибка при сохранении: {ex.Message}", "Ошибка",
                    MessageBoxButton.OK, MessageBoxImage.Error);
            }
        }

        public static async Task<string> GetToken(string rpUID, string bearer)
        {
            try
            {
                string returnToken = null;
                string uri = "https://ngw.devices.sberbank.ru:9443/api/v2/oauth";

                using (HttpClientHandler handler = new HttpClientHandler())
                {
                    handler.ServerCertificateCustomValidationCallback = (message, cert, chain, sslPolicyErrors) => true;

                    using (HttpClient client = new HttpClient(handler))
                    {
                        HttpRequestMessage request = new HttpRequestMessage(HttpMethod.Post, uri);

                        request.Headers.Add("Accept", "application/json");
                        request.Headers.Add("Authorization", $"Bearer {bearer}");
                        request.Headers.Add("RqUID", rpUID);

                        var formData = new List<KeyValuePair<string, string>>
                        {
                            new KeyValuePair<string, string>("scope", "GIGACHAT_API_PERS")
                        };

                        request.Content = new FormUrlEncodedContent(formData);

                        HttpResponseMessage response = await client.SendAsync(request);

                        if (response.IsSuccessStatusCode)
                        {
                            string responseContent = await response.Content.ReadAsStringAsync();
                            var tokenResponse = JsonConvert.DeserializeObject<TokenResponse>(responseContent);
                            returnToken = tokenResponse?.access_token;
                        }
                    }
                }

                return returnToken;
            }
            catch
            {
                return null;
            }
        }

        public static async Task<string> GenerateImage(string accessToken, string prompt)
        {
            try
            {
                string uri = "https://gigachat.devices.sberbank.ru/api/v1/chat/completions";

                using (HttpClientHandler handler = new HttpClientHandler())
                {
                    handler.ServerCertificateCustomValidationCallback = (message, cert, chain, sslPolicyErrors) => true;

                    using (HttpClient client = new HttpClient(handler))
                    {
                        client.Timeout = TimeSpan.FromSeconds(120);

                        HttpRequestMessage request = new HttpRequestMessage(HttpMethod.Post, uri);

                        request.Headers.Add("Accept", "application/json");
                        request.Headers.Add("Authorization", $"Bearer {accessToken}");

                        var requestBody = new
                        {
                            model = "GigaChat",
                            messages = new[]
                            {
                                new
                                {
                                    role = "system",
                                    content = "Ты - профессиональный художник. Создавай красивые и детализированные изображения в высоком качестве. Учитывай все детали запроса."
                                },
                                new
                                {
                                    role = "user",
                                    content = prompt
                                }
                            },
                            function_call = "auto"
                        };

                        string jsonBody = JsonConvert.SerializeObject(requestBody);
                        request.Content = new StringContent(jsonBody, Encoding.UTF8, "application/json");

                        HttpResponseMessage response = await client.SendAsync(request);

                        if (response.IsSuccessStatusCode)
                        {
                            string responseContent = await response.Content.ReadAsStringAsync();
                            var chatResponse = JsonConvert.DeserializeObject<ChatCompletionResponse>(responseContent);

                            if (chatResponse?.choices != null && chatResponse.choices.Count > 0)
                            {
                                string content = chatResponse.choices[0]?.message?.content;

                                if (!string.IsNullOrEmpty(content))
                                {
                                    var match = Regex.Match(content, @"<img\s+src=""([^""]+)""\s+fuse=""true""\s*/>");

                                    if (match.Success && match.Groups.Count > 1)
                                    {
                                        return match.Groups[1].Value;
                                    }
                                }
                            }
                        }
                    }
                }

                return null;
            }
            catch
            {
                return null;
            }
        }

        public static async Task<string> DownloadImage(string accessToken, string fileId)
        {
            try
            {
                string uri = $"https://gigachat.devices.sberbank.ru/api/v1/files/{fileId}/content";
                string fileName = $"gigachat_wallpaper_{DateTime.Now:yyyyMMdd_HHmmss}.jpg";
                string downloadPath = System.IO.Path.Combine(AppDomain.CurrentDomain.BaseDirectory, fileName);

                using (HttpClientHandler handler = new HttpClientHandler())
                {
                    handler.ServerCertificateCustomValidationCallback = (message, cert, chain, sslPolicyErrors) => true;

                    using (HttpClient client = new HttpClient(handler))
                    {
                        client.Timeout = TimeSpan.FromSeconds(60);

                        HttpRequestMessage request = new HttpRequestMessage(HttpMethod.Get, uri);

                        request.Headers.Add("Accept", "application/jpg");
                        request.Headers.Add("Authorization", $"Bearer {accessToken}");

                        HttpResponseMessage response = await client.SendAsync(request);

                        if (response.IsSuccessStatusCode)
                        {
                            byte[] imageBytes = await response.Content.ReadAsByteArrayAsync();

                            if (imageBytes.Length == 0)
                            {
                                return null;
                            }

                            var contentType = response.Content.Headers.ContentType?.MediaType;
                            string extension = ".jpg";

                            if (contentType != null)
                            {
                                if (contentType.ToLower() == "image/png")
                                {
                                    extension = ".png";
                                }
                                else if (contentType.ToLower() == "image/jpeg" || contentType.ToLower() == "image/jpg")
                                {
                                    extension = ".jpg";
                                }
                                else if (contentType.ToLower() == "image/bmp")
                                {
                                    extension = ".bmp";
                                }
                                else if (contentType.ToLower() == "image/webp")
                                {
                                    extension = ".webp";
                                }
                            }

                            if (!fileName.EndsWith(extension, StringComparison.OrdinalIgnoreCase))
                            {
                                fileName = System.IO.Path.GetFileNameWithoutExtension(fileName) + extension;
                                downloadPath = System.IO.Path.Combine(AppDomain.CurrentDomain.BaseDirectory, fileName);
                            }

                            File.WriteAllBytes(downloadPath, imageBytes);

                            if (File.Exists(downloadPath))
                            {
                                return downloadPath;
                            }
                        }
                    }
                }

                return null;
            }
            catch
            {
                return null;
            }
        }
    }

    public class TokenResponse
    {
        public string access_token { get; set; }
        public string expired_at { get; set; }
    }

    public class ChatCompletionResponse
    {
        public List<Choice> choices { get; set; }
        public long created { get; set; }
        public string model { get; set; }
        public string @object { get; set; }
        public Usage usage { get; set; }
    }

    public class Choice
    {
        public Message message { get; set; }
        public int index { get; set; }
        public string finish_reason { get; set; }
    }

    public class Message
    {
        public string content { get; set; }
        public string role { get; set; }
    }

    public class Usage
    {
        public int prompt_tokens { get; set; }
        public int completion_tokens { get; set; }
        public int total_tokens { get; set; }
    }
}﻿using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Runtime.InteropServices;
using System.Text;
using System.Threading.Tasks;
using System.Windows;

namespace GigaChatImage_Kantuganov
{
    public static class WallpaperHelper
    {
        private const int SPI_SETDESKWALLPAPER = 0x0014;
        private const int SPIF_UPDATEINIFILE = 0x01;
        private const int SPIF_SENDWININICHANGE = 0x02;

        [DllImport("user32.dll", CharSet = CharSet.Auto)]
        private static extern int SystemParametersInfo(
            int uAction,
            int uParam,
            string lpvParam,
            int fuWinIni
        );

        public static bool SetWallpaper(string imagePath)
        {
            try
            {
                if (!File.Exists(imagePath))
                {
                    MessageBox.Show($"Файл не найден: {imagePath}", "Ошибка",
                        MessageBoxButton.OK, MessageBoxImage.Error);
                    return false;
                }

                int result = SystemParametersInfo(
                    SPI_SETDESKWALLPAPER,
                    0,
                    imagePath,
                    SPIF_UPDATEINIFILE | SPIF_SENDWININICHANGE
                );

                return result != 0;
            }
            catch (Exception ex)
            {
                MessageBox.Show($"Ошибка при установке обоев: {ex.Message}", "Ошибка",
                    MessageBoxButton.OK, MessageBoxImage.Error);
                return false;
            }
        }
    }
}
// <autogenerated />
using System;
using System.Reflection;
[assembly: global::System.Runtime.Versioning.TargetFrameworkAttribute(".NETCoreApp,Version=v8.0", FrameworkDisplayName = ".NET 8.0")]
﻿#pragma checksum "..\..\..\App.xaml" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "3CAB9925E19884014FE17A717ACBDB0A66A47BF0"
//------------------------------------------------------------------------------
// <auto-generated>
//     Этот код создан программой.
//     Исполняемая версия:4.0.30319.42000
//
//     Изменения в этом файле могут привести к неправильной работе и будут потеряны в случае
//     повторной генерации кода.
// </auto-generated>
//------------------------------------------------------------------------------

using GigaChatImage_Kantuganov;
using System;
using System.Diagnostics;
using System.Windows;
using System.Windows.Automation;
using System.Windows.Controls;
using System.Windows.Controls.Primitives;
using System.Windows.Controls.Ribbon;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Ink;
using System.Windows.Input;
using System.Windows.Markup;
using System.Windows.Media;
using System.Windows.Media.Animation;
using System.Windows.Media.Effects;
using System.Windows.Media.Imaging;
using System.Windows.Media.Media3D;
using System.Windows.Media.TextFormatting;
using System.Windows.Navigation;
using System.Windows.Shapes;
using System.Windows.Shell;


namespace GigaChatImage_Kantuganov {
    
    
    /// <summary>
    /// App
    /// </summary>
    public partial class App : System.Windows.Application {
        
        /// <summary>
        /// InitializeComponent
        /// </summary>
        [System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [System.CodeDom.Compiler.GeneratedCodeAttribute("PresentationBuildTasks", "8.0.8.0")]
        public void InitializeComponent() {
            
            #line 5 "..\..\..\App.xaml"
            this.StartupUri = new System.Uri("MainWindow.xaml", System.UriKind.Relative);
            
            #line default
            #line hidden
        }
        
        /// <summary>
        /// Application Entry Point.
        /// </summary>
        [System.STAThreadAttribute()]
        [System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [System.CodeDom.Compiler.GeneratedCodeAttribute("PresentationBuildTasks", "8.0.8.0")]
        public static void Main() {
            GigaChatImage_Kantuganov.App app = new GigaChatImage_Kantuganov.App();
            app.InitializeComponent();
            app.Run();
        }
    }
}

﻿#pragma checksum "..\..\..\App.xaml" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "3CAB9925E19884014FE17A717ACBDB0A66A47BF0"
//------------------------------------------------------------------------------
// <auto-generated>
//     Этот код создан программой.
//     Исполняемая версия:4.0.30319.42000
//
//     Изменения в этом файле могут привести к неправильной работе и будут потеряны в случае
//     повторной генерации кода.
// </auto-generated>
//------------------------------------------------------------------------------

using GigaChatImage_Kantuganov;
using System;
using System.Diagnostics;
using System.Windows;
using System.Windows.Automation;
using System.Windows.Controls;
using System.Windows.Controls.Primitives;
using System.Windows.Controls.Ribbon;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Ink;
using System.Windows.Input;
using System.Windows.Markup;
using System.Windows.Media;
using System.Windows.Media.Animation;
using System.Windows.Media.Effects;
using System.Windows.Media.Imaging;
using System.Windows.Media.Media3D;
using System.Windows.Media.TextFormatting;
using System.Windows.Navigation;
using System.Windows.Shapes;
using System.Windows.Shell;


namespace GigaChatImage_Kantuganov {
    
    
    /// <summary>
    /// App
    /// </summary>
    public partial class App : System.Windows.Application {
        
        /// <summary>
        /// InitializeComponent
        /// </summary>
        [System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [System.CodeDom.Compiler.GeneratedCodeAttribute("PresentationBuildTasks", "8.0.8.0")]
        public void InitializeComponent() {
            
            #line 5 "..\..\..\App.xaml"
            this.StartupUri = new System.Uri("MainWindow.xaml", System.UriKind.Relative);
            
            #line default
            #line hidden
        }
        
        /// <summary>
        /// Application Entry Point.
        /// </summary>
        [System.STAThreadAttribute()]
        [System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [System.CodeDom.Compiler.GeneratedCodeAttribute("PresentationBuildTasks", "8.0.8.0")]
        public static void Main() {
            GigaChatImage_Kantuganov.App app = new GigaChatImage_Kantuganov.App();
            app.InitializeComponent();
            app.Run();
        }
    }
}

//------------------------------------------------------------------------------
// <auto-generated>
//     Этот код создан программой.
//     Исполняемая версия:4.0.30319.42000
//
//     Изменения в этом файле могут привести к неправильной работе и будут потеряны в случае
//     повторной генерации кода.
// </auto-generated>
//------------------------------------------------------------------------------

using System;
using System.Reflection;

[assembly: System.Reflection.AssemblyCompanyAttribute("GigaChatImage_Kantuganov")]
[assembly: System.Reflection.AssemblyConfigurationAttribute("Debug")]
[assembly: System.Reflection.AssemblyFileVersionAttribute("1.0.0.0")]
[assembly: System.Reflection.AssemblyInformationalVersionAttribute("1.0.0+f59f8b77f442713ce78c55cb9cb15f04f6211d71")]
[assembly: System.Reflection.AssemblyProductAttribute("GigaChatImage_Kantuganov")]
[assembly: System.Reflection.AssemblyTitleAttribute("GigaChatImage_Kantuganov")]
[assembly: System.Reflection.AssemblyVersionAttribute("1.0.0.0")]
[assembly: System.Runtime.Versioning.TargetPlatformAttribute("Windows7.0")]
[assembly: System.Runtime.Versioning.SupportedOSPlatformAttribute("Windows7.0")]

// Создано классом WriteCodeFragment MSBuild.

// <auto-generated/>
global using global::System;
global using global::System.Collections.Generic;
global using global::System.Linq;
global using global::System.Threading;
global using global::System.Threading.Tasks;
//------------------------------------------------------------------------------
// <auto-generated>
//     Этот код создан программой.
//     Исполняемая версия:4.0.30319.42000
//
//     Изменения в этом файле могут привести к неправильной работе и будут потеряны в случае
//     повторной генерации кода.
// </auto-generated>
//------------------------------------------------------------------------------

using System;
using System.Reflection;

[assembly: System.Reflection.AssemblyCompanyAttribute("GigaChatImage_Kantuganov")]
[assembly: System.Reflection.AssemblyConfigurationAttribute("Debug")]
[assembly: System.Reflection.AssemblyFileVersionAttribute("1.0.0.0")]
[assembly: System.Reflection.AssemblyInformationalVersionAttribute("1.0.0+f59f8b77f442713ce78c55cb9cb15f04f6211d71")]
[assembly: System.Reflection.AssemblyProductAttribute("GigaChatImage_Kantuganov")]
[assembly: System.Reflection.AssemblyTitleAttribute("GigaChatImage_Kantuganov")]
[assembly: System.Reflection.AssemblyVersionAttribute("1.0.0.0")]
[assembly: System.Runtime.Versioning.TargetPlatformAttribute("Windows7.0")]
[assembly: System.Runtime.Versioning.SupportedOSPlatformAttribute("Windows7.0")]

// Создано классом WriteCodeFragment MSBuild.

// <auto-generated/>
global using global::System;
global using global::System.Collections.Generic;
global using global::System.Linq;
global using global::System.Threading;
global using global::System.Threading.Tasks;
﻿#pragma checksum "..\..\..\MainWindow.xaml" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "6E6D1B10ABF8D21932A3F77F1A0AB2B9028E089B"
//------------------------------------------------------------------------------
// <auto-generated>
//     Этот код создан программой.
//     Исполняемая версия:4.0.30319.42000
//
//     Изменения в этом файле могут привести к неправильной работе и будут потеряны в случае
//     повторной генерации кода.
// </auto-generated>
//------------------------------------------------------------------------------

using GigaChatImage_Kantuganov;
using System;
using System.Diagnostics;
using System.Windows;
using System.Windows.Automation;
using System.Windows.Controls;
using System.Windows.Controls.Primitives;
using System.Windows.Controls.Ribbon;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Ink;
using System.Windows.Input;
using System.Windows.Markup;
using System.Windows.Media;
using System.Windows.Media.Animation;
using System.Windows.Media.Effects;
using System.Windows.Media.Imaging;
using System.Windows.Media.Media3D;
using System.Windows.Media.TextFormatting;
using System.Windows.Navigation;
using System.Windows.Shapes;
using System.Windows.Shell;


namespace GigaChatImage_Kantuganov {
    
    
    /// <summary>
    /// MainWindow
    /// </summary>
    public partial class MainWindow : System.Windows.Window, System.Windows.Markup.IComponentConnector {
        
        
        #line 34 "..\..\..\MainWindow.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.TextBox PromptTextBox;
        
        #line default
        #line hidden
        
        
        #line 57 "..\..\..\MainWindow.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.ComboBox StyleComboBox;
        
        #line default
        #line hidden
        
        
        #line 72 "..\..\..\MainWindow.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.ComboBox ColorPaletteComboBox;
        
        #line default
        #line hidden
        
        
        #line 87 "..\..\..\MainWindow.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.ComboBox AspectRatioComboBox;
        
        #line default
        #line hidden
        
        
        #line 100 "..\..\..\MainWindow.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.ComboBox QualityComboBox;
        
        #line default
        #line hidden
        
        
        #line 113 "..\..\..\MainWindow.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.CheckBox AddDetailsCheckBox;
        
        #line default
        #line hidden
        
        
        #line 117 "..\..\..\MainWindow.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.CheckBox AddLightingCheckBox;
        
        #line default
        #line hidden
        
        
        #line 121 "..\..\..\MainWindow.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.CheckBox HighResCheckBox;
        
        #line default
        #line hidden
        
        
        #line 130 "..\..\..\MainWindow.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.TextBox GeneratedPromptTextBox;
        
        #line default
        #line hidden
        
        
        #line 136 "..\..\..\MainWindow.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.Button CopyPromptButton;
        
        #line default
        #line hidden
        
        
        #line 146 "..\..\..\MainWindow.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.TextBlock StatusTextBlock;
        
        #line default
        #line hidden
        
        
        #line 150 "..\..\..\MainWindow.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.ProgressBar ProgressBar;
        
        #line default
        #line hidden
        
        
        #line 161 "..\..\..\MainWindow.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.Button GenerateButton;
        
        #line default
        #line hidden
        
        
        #line 172 "..\..\..\MainWindow.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.Button SetWallpaperButton;
        
        #line default
        #line hidden
        
        
        #line 181 "..\..\..\MainWindow.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.Button SaveButton;
        
        #line default
        #line hidden
        
        private bool _contentLoaded;
        
        /// <summary>
        /// InitializeComponent
        /// </summary>
        [System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [System.CodeDom.Compiler.GeneratedCodeAttribute("PresentationBuildTasks", "8.0.8.0")]
        public void InitializeComponent() {
            if (_contentLoaded) {
                return;
            }
            _contentLoaded = true;
            System.Uri resourceLocater = new System.Uri("/GigaChatImage_Kantuganov;component/mainwindow.xaml", System.UriKind.Relative);
            
            #line 1 "..\..\..\MainWindow.xaml"
            System.Windows.Application.LoadComponent(this, resourceLocater);
            
            #line default
            #line hidden
        }
        
        [System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [System.CodeDom.Compiler.GeneratedCodeAttribute("PresentationBuildTasks", "8.0.8.0")]
        [System.ComponentModel.EditorBrowsableAttribute(System.ComponentModel.EditorBrowsableState.Never)]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Design", "CA1033:InterfaceMethodsShouldBeCallableByChildTypes")]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Maintainability", "CA1502:AvoidExcessiveComplexity")]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1800:DoNotCastUnnecessarily")]
        void System.Windows.Markup.IComponentConnector.Connect(int connectionId, object target) {
            switch (connectionId)
            {
            case 1:
            this.PromptTextBox = ((System.Windows.Controls.TextBox)(target));
            return;
            case 2:
            this.StyleComboBox = ((System.Windows.Controls.ComboBox)(target));
            return;
            case 3:
            this.ColorPaletteComboBox = ((System.Windows.Controls.ComboBox)(target));
            return;
            case 4:
            this.AspectRatioComboBox = ((System.Windows.Controls.ComboBox)(target));
            return;
            case 5:
            this.QualityComboBox = ((System.Windows.Controls.ComboBox)(target));
            return;
            case 6:
            this.AddDetailsCheckBox = ((System.Windows.Controls.CheckBox)(target));
            return;
            case 7:
            this.AddLightingCheckBox = ((System.Windows.Controls.CheckBox)(target));
            return;
            case 8:
            this.HighResCheckBox = ((System.Windows.Controls.CheckBox)(target));
            return;
            case 9:
            this.GeneratedPromptTextBox = ((System.Windows.Controls.TextBox)(target));
            return;
            case 10:
            this.CopyPromptButton = ((System.Windows.Controls.Button)(target));
            return;
            case 11:
            this.StatusTextBlock = ((System.Windows.Controls.TextBlock)(target));
            return;
            case 12:
            this.ProgressBar = ((System.Windows.Controls.ProgressBar)(target));
            return;
            case 13:
            this.GenerateButton = ((System.Windows.Controls.Button)(target));
            
            #line 168 "..\..\..\MainWindow.xaml"
            this.GenerateButton.Click += new System.Windows.RoutedEventHandler(this.GenerateButton_Click);
            
            #line default
            #line hidden
            return;
            case 14:
            this.SetWallpaperButton = ((System.Windows.Controls.Button)(target));
            
            #line 179 "..\..\..\MainWindow.xaml"
            this.SetWallpaperButton.Click += new System.Windows.RoutedEventHandler(this.SetWallpaperButton_Click);
            
            #line default
            #line hidden
            return;
            case 15:
            this.SaveButton = ((System.Windows.Controls.Button)(target));
            
            #line 186 "..\..\..\MainWindow.xaml"
            this.SaveButton.Click += new System.Windows.RoutedEventHandler(this.SaveButton_Click);
            
            #line default
            #line hidden
            return;
            }
            this._contentLoaded = true;
        }
    }
}

﻿#pragma checksum "..\..\..\MainWindow.xaml" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "6E6D1B10ABF8D21932A3F77F1A0AB2B9028E089B"
//------------------------------------------------------------------------------
// <auto-generated>
//     Этот код создан программой.
//     Исполняемая версия:4.0.30319.42000
//
//     Изменения в этом файле могут привести к неправильной работе и будут потеряны в случае
//     повторной генерации кода.
// </auto-generated>
//------------------------------------------------------------------------------

using GigaChatImage_Kantuganov;
using System;
using System.Diagnostics;
using System.Windows;
using System.Windows.Automation;
using System.Windows.Controls;
using System.Windows.Controls.Primitives;
using System.Windows.Controls.Ribbon;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Ink;
using System.Windows.Input;
using System.Windows.Markup;
using System.Windows.Media;
using System.Windows.Media.Animation;
using System.Windows.Media.Effects;
using System.Windows.Media.Imaging;
using System.Windows.Media.Media3D;
using System.Windows.Media.TextFormatting;
using System.Windows.Navigation;
using System.Windows.Shapes;
using System.Windows.Shell;


namespace GigaChatImage_Kantuganov {
    
    
    /// <summary>
    /// MainWindow
    /// </summary>
    public partial class MainWindow : System.Windows.Window, System.Windows.Markup.IComponentConnector {
        
        
        #line 34 "..\..\..\MainWindow.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.TextBox PromptTextBox;
        
        #line default
        #line hidden
        
        
        #line 57 "..\..\..\MainWindow.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.ComboBox StyleComboBox;
        
        #line default
        #line hidden
        
        
        #line 72 "..\..\..\MainWindow.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.ComboBox ColorPaletteComboBox;
        
        #line default
        #line hidden
        
        
        #line 87 "..\..\..\MainWindow.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.ComboBox AspectRatioComboBox;
        
        #line default
        #line hidden
        
        
        #line 100 "..\..\..\MainWindow.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.ComboBox QualityComboBox;
        
        #line default
        #line hidden
        
        
        #line 113 "..\..\..\MainWindow.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.CheckBox AddDetailsCheckBox;
        
        #line default
        #line hidden
        
        
        #line 117 "..\..\..\MainWindow.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.CheckBox AddLightingCheckBox;
        
        #line default
        #line hidden
        
        
        #line 121 "..\..\..\MainWindow.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.CheckBox HighResCheckBox;
        
        #line default
        #line hidden
        
        
        #line 130 "..\..\..\MainWindow.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.TextBox GeneratedPromptTextBox;
        
        #line default
        #line hidden
        
        
        #line 136 "..\..\..\MainWindow.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.Button CopyPromptButton;
        
        #line default
        #line hidden
        
        
        #line 146 "..\..\..\MainWindow.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.TextBlock StatusTextBlock;
        
        #line default
        #line hidden
        
        
        #line 150 "..\..\..\MainWindow.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.ProgressBar ProgressBar;
        
        #line default
        #line hidden
        
        
        #line 161 "..\..\..\MainWindow.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.Button GenerateButton;
        
        #line default
        #line hidden
        
        
        #line 172 "..\..\..\MainWindow.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.Button SetWallpaperButton;
        
        #line default
        #line hidden
        
        
        #line 181 "..\..\..\MainWindow.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.Button SaveButton;
        
        #line default
        #line hidden
        
        private bool _contentLoaded;
        
        /// <summary>
        /// InitializeComponent
        /// </summary>
        [System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [System.CodeDom.Compiler.GeneratedCodeAttribute("PresentationBuildTasks", "8.0.8.0")]
        public void InitializeComponent() {
            if (_contentLoaded) {
                return;
            }
            _contentLoaded = true;
            System.Uri resourceLocater = new System.Uri("/GigaChatImage_Kantuganov;component/mainwindow.xaml", System.UriKind.Relative);
            
            #line 1 "..\..\..\MainWindow.xaml"
            System.Windows.Application.LoadComponent(this, resourceLocater);
            
            #line default
            #line hidden
        }
        
        [System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [System.CodeDom.Compiler.GeneratedCodeAttribute("PresentationBuildTasks", "8.0.8.0")]
        [System.ComponentModel.EditorBrowsableAttribute(System.ComponentModel.EditorBrowsableState.Never)]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Design", "CA1033:InterfaceMethodsShouldBeCallableByChildTypes")]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Maintainability", "CA1502:AvoidExcessiveComplexity")]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1800:DoNotCastUnnecessarily")]
        void System.Windows.Markup.IComponentConnector.Connect(int connectionId, object target) {
            switch (connectionId)
            {
            case 1:
            this.PromptTextBox = ((System.Windows.Controls.TextBox)(target));
            return;
            case 2:
            this.StyleComboBox = ((System.Windows.Controls.ComboBox)(target));
            return;
            case 3:
            this.ColorPaletteComboBox = ((System.Windows.Controls.ComboBox)(target));
            return;
            case 4:
            this.AspectRatioComboBox = ((System.Windows.Controls.ComboBox)(target));
            return;
            case 5:
            this.QualityComboBox = ((System.Windows.Controls.ComboBox)(target));
            return;
            case 6:
            this.AddDetailsCheckBox = ((System.Windows.Controls.CheckBox)(target));
            return;
            case 7:
            this.AddLightingCheckBox = ((System.Windows.Controls.CheckBox)(target));
            return;
            case 8:
            this.HighResCheckBox = ((System.Windows.Controls.CheckBox)(target));
            return;
            case 9:
            this.GeneratedPromptTextBox = ((System.Windows.Controls.TextBox)(target));
            return;
            case 10:
            this.CopyPromptButton = ((System.Windows.Controls.Button)(target));
            return;
            case 11:
            this.StatusTextBlock = ((System.Windows.Controls.TextBlock)(target));
            return;
            case 12:
            this.ProgressBar = ((System.Windows.Controls.ProgressBar)(target));
            return;
            case 13:
            this.GenerateButton = ((System.Windows.Controls.Button)(target));
            
            #line 168 "..\..\..\MainWindow.xaml"
            this.GenerateButton.Click += new System.Windows.RoutedEventHandler(this.GenerateButton_Click);
            
            #line default
            #line hidden
            return;
            case 14:
            this.SetWallpaperButton = ((System.Windows.Controls.Button)(target));
            
            #line 179 "..\..\..\MainWindow.xaml"
            this.SetWallpaperButton.Click += new System.Windows.RoutedEventHandler(this.SetWallpaperButton_Click);
            
            #line default
            #line hidden
            return;
            case 15:
            this.SaveButton = ((System.Windows.Controls.Button)(target));
            
            #line 186 "..\..\..\MainWindow.xaml"
            this.SaveButton.Click += new System.Windows.RoutedEventHandler(this.SaveButton_Click);
            
            #line default
            #line hidden
            return;
            }
            this._contentLoaded = true;
        }
    }
}

